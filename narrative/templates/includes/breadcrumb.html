{% load wagtailcore_tags narrative_tags %}
{# Breadcrumb navigation showing current location in the narrative web #}

{% if fabula_theme == 'writerly' %}
{# ===== WRITERLY BREADCRUMB ===== #}
<div class="flex items-center gap-3">
    <button onclick="history.back()"
            class="group flex items-center gap-2 px-3 py-2 text-sm transition-all duration-200"
            style="color: var(--f-fg-tertiary); background: var(--f-bg-elevated); border: 1px solid var(--f-border-light); border-radius: 0.5rem;"
            title="Go back">
        <i data-lucide="chevron-left" class="w-4 h-4 group-hover:-translate-x-0.5 transition-transform"></i>
        <span class="hidden sm:inline font-medium">Back</span>
    </button>

    <div class="flex items-center gap-2.5 px-4 py-2 rounded-lg"
         style="background: var(--f-bg-elevated); border: 1px solid var(--f-border-light);">
        {% if page.specific_class_name == 'EventPage' %}
            <div class="p-1 rounded" style="background: color-mix(in srgb, var(--f-accent-primary) 8%, transparent);">
                <i data-lucide="zap" class="w-4 h-4" style="color: var(--f-accent-primary);"></i>
            </div>
        {% elif page.specific_class_name == 'CharacterPage' %}
            <div class="p-1 rounded" style="background: color-mix(in srgb, var(--f-accent-green) 8%, transparent);">
                <i data-lucide="user" class="w-4 h-4" style="color: var(--f-accent-green);"></i>
            </div>
        {% elif page.specific_class_name == 'EpisodePage' %}
            <div class="p-1 rounded" style="background: color-mix(in srgb, var(--f-accent-blue) 8%, transparent);">
                <i data-lucide="film" class="w-4 h-4" style="color: var(--f-accent-blue);"></i>
            </div>
        {% elif page.specific_class_name == 'ThemeIndexPage' %}
            <div class="p-1 rounded" style="background: color-mix(in srgb, var(--f-accent-violet) 8%, transparent);">
                <i data-lucide="sparkles" class="w-4 h-4" style="color: var(--f-accent-violet);"></i>
            </div>
        {% else %}
            <div class="p-1 rounded" style="background: var(--f-bg-elevated);">
                <i data-lucide="file-text" class="w-4 h-4" style="color: var(--f-fg-placeholder);"></i>
            </div>
        {% endif %}

        <span class="text-sm font-medium max-w-[200px] truncate" style="color: var(--f-fg-heading);">
            {{ page.title }}
        </span>
    </div>
</div>

{% else %}
{# ===== DARK BREADCRUMB (original) ===== #}
<div class="flex items-center gap-3">
    {# Back button with enhanced styling #}
    <button onclick="history.back()"
            class="group flex items-center gap-2 px-3 py-2 text-sm text-slate-400 hover:text-white bg-slate-800/50 hover:bg-slate-800 border border-slate-700/50 hover:border-slate-600 rounded-lg transition-all duration-200 hover:scale-105"
            title="Go back">
        <i data-lucide="chevron-left" class="w-4 h-4 group-hover:-translate-x-0.5 transition-transform"></i>
        <span class="hidden sm:inline font-medium">Back</span>
    </button>

    {# Current page indicator with enhanced styling #}
    <div class="flex items-center gap-2.5 px-4 py-2 bg-slate-800/40 border border-slate-700/40 rounded-lg backdrop-blur-sm">
        {# Icon based on page type with glow effect #}
        {% if page.specific_class_name == 'EventPage' %}
            <div class="p-1 bg-amber-500/10 rounded">
                <i data-lucide="zap" class="w-4 h-4 text-amber-400"></i>
            </div>
        {% elif page.specific_class_name == 'CharacterPage' %}
            <div class="p-1 bg-emerald-500/10 rounded">
                <i data-lucide="user" class="w-4 h-4 text-emerald-400"></i>
            </div>
        {% elif page.specific_class_name == 'EpisodePage' %}
            <div class="p-1 bg-blue-500/10 rounded">
                <i data-lucide="film" class="w-4 h-4 text-blue-400"></i>
            </div>
        {% elif page.specific_class_name == 'ThemeIndexPage' %}
            <div class="p-1 bg-violet-500/10 rounded">
                <i data-lucide="sparkles" class="w-4 h-4 text-violet-400"></i>
            </div>
        {% else %}
            <div class="p-1 bg-slate-500/10 rounded">
                <i data-lucide="file-text" class="w-4 h-4 text-slate-400"></i>
            </div>
        {% endif %}

        <span class="text-sm text-slate-200 font-semibold max-w-[200px] truncate">
            {{ page.title }}
        </span>
    </div>
</div>
{% endif %}
